internal class Program
{
    private static void Main(string[] args)
    {
        Seller seller = new Seller();
        Player player = new Player(200);
        Store store = new Store(seller, player);
        store.ShowMenu();
    }
}

class Store
{
    private Seller _seller;
    private Player _player;

    public Store(Seller seller, Player player)
    {
        _seller = seller;
        _player = player;
    }

    private void ShowProductSeller()
    {
        _seller.ShowItems();
    }

    private void ShowProductPlayer()
    {
        _player.ShowItems();
    }

    private bool BuyProduct()
    {
        ShowProductSeller();

        Console.WriteLine("Введите название товара, который хотите приобрести: ");
        string productName = Console.ReadLine();

        Product productToBuy = _seller.FindProduct(productName);

        if (productToBuy == null)
        {
            return false;
        }

        if (_player.CanBuy(productToBuy))
        {
            _player.PayForProduct(productToBuy);
            _seller.SellProduct(productToBuy);
            Console.WriteLine($"Вы приобрели товар - {productToBuy.Name}");
            return true;
        }
        else
        {
            Console.WriteLine("Не удалось купить товар, недостаточно средств.");
            return false;
        }
    }

    public void ShowMenu()
    {
        const string CommandShowAllProducts = "1";
        const string CommandBuyProducts = "2";
        const string CommandShowAllProductsPlayer = "3";
        const string CommandExit = "4";

        bool isPlaying = true;

        while (isPlaying)
        {
            Console.WriteLine("Добро пожаловать в магазин!");
            _seller.ShowMoney();
            Console.WriteLine("У меня есть список товаров которые ты можешь приобрести.");
            Console.WriteLine($"Выберите действие: ");
            Console.WriteLine($"{CommandShowAllProducts} - Показать список товаров у продавца.");
            Console.WriteLine($"{CommandBuyProducts} - Купить товар.");
            Console.WriteLine($"{CommandShowAllProductsPlayer} - Показать список товаров у игрока.");
            Console.WriteLine($"{CommandExit} - Выйти из магазина.");
            Console.Write($"Игрок - ");
            _player.ShowMoney();
            string userInput = Console.ReadLine();

            switch (userInput)
            {
                case CommandShowAllProducts:
                    ShowProductSeller();
                    break;

                case CommandBuyProducts:
                    BuyProduct();
                    break;

                case CommandShowAllProductsPlayer:
                    ShowProductPlayer();
                    break;

                case CommandExit:
                    isPlaying = false;
                    break;

                default:
                    Console.WriteLine("Такого действия нет.");
                    break;
            }

            Console.WriteLine("Нажмите любую кнопку для продолжения.");
            Console.ReadKey();
            Console.Clear();
        }
    }
}

public abstract class MarketAgent
{
    protected int money;
    protected List<Product> items = new List<Product>();

    public MarketAgent (int initialMoney)
    {
        money = initialMoney;
    }

    public void ShowItems()
    {
        Console.WriteLine("Список товаров: ");

        foreach (var item in items)
        {
            item.ShowInfoProduct();
        }
    }

    public void ShowMoney()
    {
        Console.WriteLine($"Баланс средств: {money} ед. золота.");
    }
}

public class Seller : MarketAgent
{
    public Seller() : base(0)
    {
        CreateProducts();
    }

    public Product FindProduct(string productName)
    {
        string productNameLower = productName.ToLower();

        for (int i = 0; i < items.Count; i++)
        {
            if (items[i].Name.ToLower() == productNameLower)
            {
                return items[i];
            }
        }

        Console.WriteLine("Данного товара нет в магазине");
        return null;
    }

    public void SellProduct(Product product)
    {
        items.Remove(product);
        money += product.Price;
    }
    
    private void CreateProducts()
    {
        items.Clear();

        string[] nameProducts = { "Меч", "Броня", "Перчатки", "Ботинки", "Штаны", "Шляпа" };
        int[] pricesProducts = { 85, 100, 25, 25, 50, 20 };

        for (int i = 0; i < nameProducts.Length; i++)
        {
            items.Add(new Product(nameProducts[i], pricesProducts[i]));
        }
    }
}

public class Player : MarketAgent
{
    public Player(int initialMoney) : base (initialMoney) { }

    public void PayForProduct(Product product)
    {
        money -= product.Price;
        items.Add(product);
    }

    public bool CanBuy(Product product)
    {
        return money >= product.Price;
    }
}

public class Product
{
    public Product(string name, int price)
    {
        Name = name;
        Price = price;
    }

    public string Name { get; private set; }
    public int Price { get; private set; }

    public void ShowInfoProduct()
    {
        Console.WriteLine($"{Name} по цене {Price} ед. золота.");
    }
}
